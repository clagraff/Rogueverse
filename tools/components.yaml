config:
  discriminatorField: "type"

classes:
  # Base classes
  Lifetime:
    description: "Base class for components with a limited lifespan that can expire after a certain number of ticks"
    fields:
      lifetime:
        type: int
        description: "Remaining lifetime of the current component"
        default: 0  # Mutable with default

  # Lifetime subclasses
  BeforeTick:
    description: "Component that is removed before a tick update if its lifetime has expired"
    extends: Lifetime
    fields: {}

  AfterTick:
    description: "Component that is removed after a tick update if its lifetime has expired"
    extends: Lifetime
    fields: {}

  # Cell (container)
  Cell:
    description: "Container for all entities and components in the game world"
    fields:
      lastId:
        type: int
        default: 0
      components:
        type: "Map<String, Map<int, dynamic>>"

  # Basic components
  Name:
    description: "A user-friendly, non-unique label for an entity"
    fields:
      name:
        type: String
        # No default = final field

  LocalPosition:
    description: "The grid-based position of an entity within the game world"
    fields:
      x:
        type: int
        default: 0  # Mutable with default
      y:
        type: int
        default: 0  # Mutable with default

  # Movement components
  MoveByIntent:
    description: "Component that signals an intent to move the entity by a relative offset"
    extends: AfterTick
    fields:
      dx:
        type: int
        # No default = final field
      dy:
        type: int
        # No default = final field

  DidMove:
    description: "Component added when an entity has successfully moved in a tick"
    extends: BeforeTick
    fields:
      from:
        type: LocalPosition
        # No default = final field
      to:
        type: LocalPosition
        # No default = final field

  BlocksMovement:
    description: "Marker component indicating this entity blocks movement"
    fields: {}

  BlockedMove:
    description: "Component added when an entity's movement was blocked by another entity"
    extends: BeforeTick
    fields:
      attempted:
        type: LocalPosition
        # No default = final field

  # Control components
  PlayerControlled:
    description: "Marker component indicating the entity is controlled by the player"
    fields: {}

  AiControlled:
    description: "Marker component indicating the entity is controlled by AI"
    fields: {}

  # Visual components
  Renderable:
    description: "Component that provides a visual asset path for rendering the entity"
    fields:
      svgAssetPath:
        type: String
        # No default = final field

  # Health components
  Health:
    description: "Component representing an entity's health"
    fields:
      current:
        type: int
        default: 0  # Mutable with default
      max:
        type: int
        # No default = final field

  # Combat components
  AttackIntent:
    description: "Component indicating an intent to attack another entity"
    fields:
      targetId:
        type: int
        # No default = final field

  DidAttack:
    description: "Component added when an entity has successfully attacked another entity"
    extends: BeforeTick
    fields:
      targetId:
        type: int
        # No default = final field
      damage:
        type: int
        # No default = final field

  WasAttacked:
    description: "Component added when an entity was attacked by another entity"
    extends: BeforeTick
    fields:
      sourceId:
        type: int
        # No default = final field
      damage:
        type: int
        # No default = final field

  Dead:
    description: "Marker component indicating the entity is dead"
    fields: {}

  # Inventory components
  Inventory:
    description: "Component representing an entity's inventory"
    fields:
      items:
        type: "List<int>"
        # No default = final field, but will be initialized with empty list

  InventoryMaxCount:
    description: "Component defining the maximum number of items an entity can carry"
    fields:
      maxAmount:
        type: int
        # No default = final field

  InventoryFullFailure:
    description: "Component added when an entity fails to pick up an item due to a full inventory"
    extends: BeforeTick
    fields:
      targetEntityId:
        type: int
        # No default = final field

  Pickupable:
    description: "Marker component indicating the entity can be picked up"
    fields: {}

  PickupIntent:
    description: "Component indicating an intent to pick up another entity"
    extends: AfterTick
    fields:
      targetEntityId:
        type: int
        # No default = final field

  PickedUp:
    description: "Component added when an entity has successfully picked up another entity"
    extends: BeforeTick
    fields:
      targetEntityId:
        type: int
        # No default = final field
